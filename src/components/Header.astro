---
import { Icon } from "astro-icon/components";
import logoHorizontal from "@/assets/logo-horizontal.png";
import { navLinks } from "@/data/navigation";
import { contactInfo } from "@/data/contact";

const pathname = Astro.url.pathname;
---

<header class="sticky top-0 z-50 bg-background border-b border-border">
  <div class="container mx-auto flex items-center justify-between py-4 px-4 md:px-8">
    <a href="/" class="flex items-center">
      <img src={logoHorizontal.src} alt="The Washboard" class="h-10 md:h-12 w-auto" />
    </a>

    <!-- Desktop nav -->
    <nav class="hidden md:flex items-center gap-8">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class="font-heading uppercase tracking-wide text-base font-medium text-foreground hover:text-primary transition-colors"
        >
          {link.label}
        </a>
      ))}
      <a
        href={contactInfo.googleMapsUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="font-heading uppercase tracking-wide inline-flex items-center gap-2 rounded-full bg-primary px-5 py-2.5 text-base font-semibold text-primary-foreground hover:opacity-90 transition-opacity"
      >
        <Icon name="lucide:map-pin" width={16} height={16} />
        Get Directions
      </a>
    </nav>

    <!-- Mobile toggle -->
    <button
      id="mobile-toggle"
      class="md:hidden text-foreground"
      aria-label="Toggle menu"
    >
      <span id="menu-icon">
        <Icon name="lucide:menu" width={24} height={24} />
      </span>
      <span id="close-icon" class="hidden">
        <Icon name="lucide:x" width={24} height={24} />
      </span>
    </button>
  </div>

  <!-- Fullscreen mobile menu -->
  <div id="mobile-menu" class="fixed inset-0 top-[4.5rem] z-40 bg-background md:hidden flex flex-col overflow-y-auto hidden">
    <!-- Nav links -->
    <nav class="flex flex-col gap-1 px-6 pt-6">
      {navLinks.map((link) => (
        <a
          href={link.href}
          class="mobile-nav-link font-heading uppercase tracking-wide text-lg font-medium text-foreground hover:text-primary py-3 border-b border-border/50"
        >
          {link.label}
        </a>
      ))}
    </nav>

    <!-- Contact info + CTA buttons at bottom -->
    <div class="mt-auto px-6 pb-8 pt-6 border-t border-border">
      <div class="flex items-start gap-3 mb-4">
        <Icon name="lucide:map-pin" width={20} height={20} class="text-primary shrink-0 mt-0.5" />
        <span class="text-foreground/80">{contactInfo.address.formatted}</span>
      </div>
      <div class="flex items-center gap-3 mb-4">
        <Icon name="lucide:phone" width={20} height={20} class="text-primary shrink-0" />
        <a
          href={contactInfo.phoneHref}
          class="text-foreground/80 hover:text-primary transition-colors"
        >
          {contactInfo.phoneFormatted}
        </a>
      </div>
      <div class="flex items-center gap-3 mb-8">
        <Icon name="lucide:clock" width={20} height={20} class="text-primary shrink-0" />
        <span class="text-foreground/80">{contactInfo.hours}</span>
      </div>

      <a
        href={contactInfo.googleMapsUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="mobile-nav-link font-heading uppercase tracking-wide inline-flex items-center justify-center gap-2 rounded-full bg-primary w-full py-4 text-base font-semibold text-primary-foreground hover:opacity-90 transition-opacity mb-3"
      >
        <Icon name="lucide:map-pin" width={18} height={18} />
        Get Directions
      </a>
      <a
        href={contactInfo.phoneHref}
        class="mobile-nav-link font-heading uppercase tracking-wide inline-flex items-center justify-center gap-2 rounded-full border-2 border-primary w-full py-4 text-base font-semibold text-primary hover:bg-primary hover:text-primary-foreground transition-colors"
      >
        <Icon name="lucide:phone" width={18} height={18} />
        Call {contactInfo.phoneFormatted}
      </a>
    </div>
  </div>
</header>

<script>
  const toggle = document.getElementById("mobile-toggle")!;
  const menu = document.getElementById("mobile-menu")!;
  const menuIcon = document.getElementById("menu-icon")!;
  const closeIcon = document.getElementById("close-icon")!;
  const navLinks = document.querySelectorAll(".mobile-nav-link");

  function closeMenu() {
    menu.classList.add("hidden");
    menuIcon.classList.remove("hidden");
    closeIcon.classList.add("hidden");
    document.body.style.overflow = "";
  }

  toggle.addEventListener("click", () => {
    const isOpen = !menu.classList.contains("hidden");
    if (isOpen) {
      closeMenu();
    } else {
      menu.classList.remove("hidden");
      menuIcon.classList.add("hidden");
      closeIcon.classList.remove("hidden");
      document.body.style.overflow = "hidden";
    }
  });

  navLinks.forEach((link) => {
    link.addEventListener("click", () => closeMenu());
  });
</script>
